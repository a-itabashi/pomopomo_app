<!DOCTYPE html>
<!DOCTYPE html>
<html>
  <head>
    <title>DesignApp</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    <link href="https://fonts.googleapis.com/css?family=Pacifico" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Orbitron" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  </head>
    <body>
      <div class="container">
        <div class="space">
          <div class="title">POMO POMO</div>
        <div class="subtitle"> 25 minutes run! AND 5 minutes break!</div>

        <div class="text-center top-clock">
          <div id="timer">25:00</div>
        </div>
    </div>
  </body>
</html>
<script type="text/javascript">
  'use strict'

  let timer = document.getElementById('timer');
  let min = document.getElementById('min');
  let sec = document.getElementById('sec');
  let startTime;
  let timeLeft;
  let timeToCountDown = 60 * 1000 * 25;
  let timerId;
  let isRunning = false;

  function countDown(){
    timerId = setTimeout(function(){
      timeLeft = timeToCountDown - (Date.now() - startTime);
      if(timeLeft < 0){
        isRunning = false;
        clearTimeout(timerId);
        timeLeft = 0;
        timeToCountDown = 0;
        updateTimer(timeLeft);
        return
      }
      updateTimer(timeLeft)
      countDown();
    },10);

    elapsed_time.textContent = (Date.now() - startTime)
  }

  function updateTimer(t){
    let d = new Date(t);
    let m = d.getMinutes();
    let s = d.getSeconds();
    m = ('0' + m).slice(-2);
    s = ('0' + s).slice(-2);
    let timerString = m + ":" + s;
    timer.textContent = timerString;
  }

  function timer_start(){
    if (isRunning === false){
      isRunning = true;
      startTime = Date.now();
      countDown();
    }else{
      isRunning = false;
      timeToCountDown = timeLeft;
      clearTimeout(timerId);
    }

  }
  window.onload = timer_start;
</script>
